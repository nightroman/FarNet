http://code.google.com/p/farnet/

= 4.0.12 =

PLUGIN PANEL VIEW MODES
(in progress, subject to change)

*) New .NET menu item "Switch full screen" allows to switch "full screen"
mode for any view mode of any FarNet panel. So that you may actually have
20 modes = 10 as usual + 10 the same but with switched "full screen".

*) PanelModeInfo - new method Clone() for shallow copy. It is useful for
creation of similar modes with a few differences.

*) IPluginPanelInfo - replaced property Modes (array of all modes) with two
methods GetMode() and SetMode() (they work only for one mode).

OTHER CHANGES

*) ControlKeyStates, KeyInfo and MouseInfo: obsolete not standard name
AltCtrlShift was replaced with classic name CtrlAltShift.

= 4.0.11 =

*) New. PanelModeInfo and IPluginPanelInfo.Modes are used for setting plugin
panel view modes (column types, widths, titles, status line and etc.). To be
continued, remarks are welcome.

*) Implemented processing of IFile.Owner for plugin panels. It can be used as
a custom column (with proper view mode and column titles, see above).

*) IFar.GetHistory() - adapted to recent Far Manger registry history changes.

*) IMenuItem - new properties Grayed, Hidded (new in Far API).

*) PaletteColor - added new values (new in Far API).

*) ControlKeyStates, KeyInfo and MouseInfo: AltCtrlShift is set obsolete (not
standard name) and will be removed soon. Use classic CtrlAltShift instead.

= 4.0.10 =

*) ISelection - new method SelectAll() selects all text in the editor. It is
a helper, you can do the same by Select() with proper parameters.

*) IViewer.CodePage for the opened viewer works now (read only).

*) IFar.CodeToChar() fixed old ANSI approach.

= 4.0.9 =

*) IFar.Write - fixed Unicode output (some characters were written as '?').
Lesson to learn: avoid Console.Write* methods in FarNet and its plugins.

= 4.0.8 =

*) IPluginPanel. New event Escaping. It is triggered when [Escape] is pressed
and the command line is empty. Basically it only helps to use [Escape] key for
closing a panel (or other action). There is no default action, perhaps it will
be added later, suggestions are welcome.

*) As far as IFar.GetWindowType(-1) is used quite frequently, a new property
IFar.WindowType is introduced: it gets a type of the current Far window:
Panels, Dialog, Editor and etc.

*) Undone stepping mode optimization because of problems for command, tool and
filer plugins dynamically registered during stepping.

*) IFar.PostStepAfterStep - fixed a subtle issue: when the first step throws an
error then the second should not be invoked even if it has been already posted.

*) Dialog controls. Improved some code originally designed in Far/1 and not
effective in Far/2.

= 4.0.7 =

*) IListMenu
- New property NoInfo: Do not show item count information at the bottom line.
- Fix. If a key handler is available and called then a standard handler, if
any, should not be called.

= 4.0.6 =

*) x64 support: FarNetMan.dll for x64 Far Manager should be copied from
Plugins.x64\FarNet. (NOTE: the build contains both x86 and x64 versions,
only FarNetMan.dll depends on a platform, FarNet.dll does not).

*) Optimized performance of stepping mechanism (IFar.PostStepXXX methods).

*) Experimental low level UI types were moved to FarNet.Raw namespace.

= 4.0.5 =

*) New IFar methods PostStepAfterKeys() and PostStepAfterStep(). This is a very
important achievement for "super-macros" that can be used now also with modal UI.
See PowerShellFar History.txt for more details.

*) Mantis #730 - thanks to DrKnS, the problem is fixed for listboxes in Far
2.0.812, so that listboxes can be used as normal. Other problems still exist
for comboedit and combolist; workaround: when a dialog has started do not use
Clear() and then Insert() without detaching and attaching items.

*) ViewFrame.LeftPos - changed from 'int' to 'long', as it is in Far API.

= 4.0.4 =

MAIN CHANGES

*) FarNet is adapted to new Far panel API in 2.0.789. Of course .NET plugins
should not care about it.

*) For technical reasons FarNet is built by Visual Studio 2008 SP1 and FarNet
C++/CLI depends on VS runtime modules. If you do not have VS 2008 then you may
have to google, download and install one of the redistributable packages:
- Microsoft Visual C++ 2008 SP1 Redistributable Package (x86)
- Microsoft Visual C++ 2008 SP1 Redistributable Package (x64)

OTHER CHANGES

*) IAnyViewer.ViewText() - switching to editor is enabled. For now if you
switch by [F6] to editor then on exit you see "The file ... was moved or
deleted. [Save]...". It is not a perfect solution perhaps but it is just
useful. If you do not like it, do not switch. Better ideas are welcome.

*) New interface IRawUI and property in IFar, TEST ONLY, they are experimental
and perhaps will be removed.

= 4.0.3 =

*) Property IListBox.Bottom - it was runtime only, now it is standard: as
usual, you can set it before opening a dialog.

*) New overloaded IFar.GetHistory() with extra parameter 'filter' returns
history strings by type(s).

*) It turned out that it is possible to unload FarNet abnormally, for example
by 'unloadp' FAR command or by some plugin manager. This scenario is not
recommended but some changes still were done for avoiding problems.

= 4.0.2 =

*) Improved exchange of strings between .NET and FAR. Note that now in some
cases FarNet is less tolerant to null input strings where text is expected.

*) Dialogs: fixed a few FAR 1 to 2 issues, fixed memory leaks in list controls
on dynamic operations on items, asked to implement IListBox.Title so that it
should work now, added new property IListBox.Bottom, etc.

*) Fixed order of history strings returned by IFar.GetHistory().

*) Wish: allow to "unload" FarNet. Note: DLLs are not phisically unloaded. It
is OK to call ExitFARW several times, the first call terminates FarNet. Then it
is safe to call GetPluginInfoW, FarNet simply returns "nothing". Other exported
functions must not be called. STILL, THIS SCENARIO IS NOT RECOMMENDED. Besides,
perhaps some FarNet sub-plugins were not designed for "half-termination".

*) Issue: http://bugs.farmanager.com/view.php?id=730
Do not make dialog list controls empty directly when a dialog is running. Use
this way: DetachItems(), Clear() or RemoveAt(), add items, AttachItems().

= 4.0.1 =

*) Due to a bug in FarNet multiarc plugin did not work. Fixed.

*) FilerEventArgs: new property OperationModes Mode. Unfortunately it is not
yet clear how to use it, you may only experiment for now.

= 4.0.0 =

ANNOUNCEMENT

From now on FarNet 4.x is for Far 2.x. FarNet 3.x is officially not supported.
Theoretically it is possible to use both FarNet 3.x and 4.x in Far 2.x at the
same time but this scenario is not supported, not tested and not recommended.

This is the first and mostly technical phase of transition from Far 1.x to 2.x.
Next FarNet version will use new Far API more effectively.

INSTALLATION

If you did not use FarNet 3.x in Far 2.x then simply do what Readme.txt says;
do read it again even if you read it before: some default names are changed.

If you use or used FarNet 3.x in Far 2.x then do in this order:

1) Remove all(!) installed files of FarNet and .NET plugins.

2) If you want to migrate old settings then rename in the registry:
HKEY_CURRENT_USER\Software\Far2\PluginHotkeys:
rename key "Plugins/FAR.NET/FarNetPlugin.dll" into "Plugins/FarNet/FarNetMan.dll"
HKEY_CURRENT_USER\Software\Far2\Plugins:
rename key "FAR.NET" info "FarNet"

3) Install FarNet, see Readme.txt for instructions.

4) Install new FarNet plugins, e.g. PowerShellFar 2.x

5) If you have your own FarNet plugins rebuild them with new FarNet.

BREAKING CHANGES (MAJOR)

*) You have to change dependency from FarNetInt.dll to FarNet.dll and rename
namespace FarManager into FarNet.

*) Removed property Targeted from panels, use new property SelectedFiles.

*) Removed property IFile.IsSelected. Originally it was introduced "a la FAR
API", but in fact it is not fit well to FarNet concept and planned evolution.

*) IViewer, IEditor - boolean property EnableSwitch is replaced with Switching
with 3 states: Auto(default), Enabled and Disabled.

BREAKING CHANGES (MINOR)

A few renamings for better consistency, discoverability and English, too.

*) IPanel:
Current -> CurrentFile
Contents -> ShownFiles
Selected -> SelectedFiles

*) All names *PanelPlugin* renamed into *PluginPanel*, e.g. new names are:
IPluginPanel, IPluginPanelInfo, CreatePluginPanel() and etc.

*) IPluginPanel.Another -> AnotherPanel

*) MessageOptions -> MsgOptions (to conform with IFar.Msg())

*) KeyCode constants:
- all names now are the same as FAR macro key names
- Ctrl, Alt, Shift moved to another type: KeyMode

*) VKeyCode constants:
- Ctrl, Alt, Shift moved to another type: VKeyMode

OTHER CHANGES

*) Do not use new properties CodePage in IEditor and IViewer, they are added,
but it turned out that FAR does not use them yet :)

= 3.3.57 =

ANNOUNCEMENT

This version is presumably the last one for FAR 1.x; the next version is going
to be for Unicode FAR 2.x. If you find new or know some old issues in 3.3.57,
report as soon as possible, this is the last call, then support of the frosen
version will be very limited.

FIX/CHANGE

*) Two accidentally related issues: fixed regression in IFar.ShowHelp();
changed how IPanel.GoToName() works with empty names: now it ignores them
(well, empty names are technically possible, but it is a weird case anyway).

HOUSEKEEPING

*) Refactoring and cleaning of legacy code shared between IFar.Msg and recently
removed obsolete IMessage.

= 3.3.56 =

*) Improved control over panel opening and possible failures. Fixed cases when
opening used to fail silently, now errors with explained reasons are shown.

*) IPanel.GoToPath() - fixed a few issues with not complete paths.

*) As it was announced, obsolete method IFar.CreateMessage() and interface
IMessage are removed. Use one of 5 overloaded IFar.Msg() methods instead.

= 3.3.55 =

CHANGES

*) Logic of IKeyMacroHost.Install(IDictionary[]) is changed. This is not a
breaking change but if you use it you have to take a look at the manual.

FIXED

*) False error "Cannot open a plugin panel at this moment." in rare cases.
*) Minor issue in error message in editor on opening a file with null name.

OBSOLETE

*) As it was announced in 3.3.44, method IFar.CreateMessage() and interface
IMessage are obsolete and will be removed. Use IFar.Msg() instead, these 5
methods provide the same features and also some improvements.

= 3.3.54 =

*) New property IPluginPanel.DataComparison - compares data attached to panel
items (normally in order to restore the current item correctly). Needed for
cases with not trivial equality.

*) New property IPluginPanel.IdleUpdate - tells to update and redraw the panel
automatically when idle. Useful for frequently changed data.

*) New user property Guid IPanel.Id - normally assigned once and used by a
creator for distinguishing panel types and reusing opened panels.

*) New method IFar.GetPluginPanel(Guid) - gets opened plugin panel by ID (see
above). Can be used for reusing already opened panels.

= 3.3.53 =

This is mostly a techical build reflecting FAR API changes up to 1.75.2494.

There are though a couple of new items in FAR.NET:
*) IPanel.GoToName() - sets an item current by its name;
*) IPanel.GoToPath() - similar to FAR command goto:<path>.

= 3.3.52 =

*) New event IControl.Drawing (e.g. it can be used to draw a user control by
IFar.WriteText and IFar.WritePalette methods).
*) New enum PaletteColor - standard FAR color palette indices.
*) New IFar.WritePalette - to write text using standard FAR colors.
*) New IFar.GetPaletteBackground, IFar.GetPaletteForeground get palette colors.
*) IAnyViewer, IViewer - new events GotFocus, LosingFocus (FAR 1.71.2406).

= 3.3.51 =

*) IEditor.Cursor is {get; set;} property now (it was {get;} only).

= 3.3.50 =

MACRO MANAGEMENT

- REMOVED obsolete IFar methods: LoadMacros(), SaveMacros(), PostMacro(). Use
new methods of IKeyMacroHost: Load(), Save(), Post().

DOCUMENTATION

- Improved look of member tables: set relative column width
- Removed annoying members inherited from System.Object
- Other little improvements and topic updates.

OTHER

- Added protected constructor to BasePlugin. It denies instances of this class.

= 3.3.49 =

MACRO MANAGEMENT

- New interface IKeyMacroHost exposed as IFar.KeyMacro property. It provides
methods for macro management.

- New class KeyMacroData: data set describing a macro. It is used by
IKeyMacroHost to get\set a macro data. Note: property names and values are
related to FAR native registry names and values, but this relation is not always
direct, RTFM.

- These IFar methods are OBSOLETE and will be removed: LoadMacros(),
SaveMacros(), PostMacro(). Use new methods of IKeyMacroHost: Load(), Save(),
Post(). Note: new Post() uses 'enableOutput' parameter which is 'false' by
default instead of PostMacro() 'disableOutput' which is 'true' by default.

DOCUMENTATION

- New style of .CHM documentation. Old MSDN style actually has more disadvatages
and it is difficult to improve. New style is somehow simpler and still can be
improved in next versions. What is already improved:
*) separated indices of properties with same names;
*) overloaded methods are all shown in member list;
*) method parameter names are shown in contents;
*) enabled advanced search features;
*) added favourites tab.

OTHER CHANGES

- IListMenu: if filter is not enabled then filter dialog should not start.

= 3.3.48 =

- Fixed error messages in viewer on Add|Subtract keys ~ open next|prev file.

- IFar: new property ILine Line { get; }: current editor line in any area (it is
$Psf.HotLine moved from PowerShellFar).

- IFar: new method KeyToName(): converts an internal key code to its string
representation.

- ILine: new property WindowType: parent window type (Editor, Panels, Dialog).

- IListMenu: by default in any list menu keys [CtrlC] and [CtrlIns] are used to
copy text of the current item to the clipboard.

= 3.3.47 =

- IListBox: new method SetFrame() to set both current and top positions.

= 3.3.46 =

- Fixed IFar.AnyEditor.EditText(): error if the text is empty and the file is
not saved on exit.

= 3.3.44 =

- One more method IFar.Msg() with extra parameter 'helpTopic' (FYI: it looks
like IMessage is completely covered by IFar.Msg() methods and perhaps it will be
removed in the future).
- IListMenu.Incremental: '*' in the end in 'prefix' mode: see help for more
(example: used by completions in PowerShellFar).
- IEditor.Open(): if a file is already opened then start position, if any, is
not set -- fixed.

= 3.3.43 =

- Avoided inconvenient for plugin development internal exceptions on loading
when plugin assemblies are changed and registry cache has to updated.
- IMessage, IFar.Msg() - if a message contains too many buttons or their text is
too long, then a dialog with a list box is used instead of a message box where
listbox items work as buttons.
- New property IPanel.IsLeft (FAR 1.71.2348).
- REMOVED IMessage.Reset() because it is not actually needed or used.

= 3.3.42 =

MENU AND LIST DIALOG CONTROLS

- BREAKING. Interface IMenuItems was completely removed and standard collection
type was used instead. Not standard methods Add() of IMenuItems were moved to
IAnyMenu.Add(). In other words, in your code replace "menu.Items.Add(<text>)"
with "menu.Add(<text>)".
- New dynamic property IBaseList.Items (IListBox, IComboBox), see help. In
brief: when a dialog is started this collection is mapped to a FAR control
dynamically, i.e. all operations (set, insert, remove and etc.) are displayed
immediately. See also new DetachItems(), AttachItems().
- New method IFar::CreateMenuItem()

OTHER

- IControl.Rect is also settable (always); IDialog.Rect is settable before
Show(); after Show() you can use new methods Move() and Resize().

= 3.3.41 =

- This is mostly a technical build for FAR 1.71.2346
- New IListBox.Title. IListBox.Text get\set is mapped to the current item text
(dynamically, i.e. when a dialog is opened).

= 3.3.40 =

- Access to dialogs and controls. New property IFar.Dialog - the current dialog
if any (including standard FAR dialogs). You can get the current dialog item as
IDialog.Focused or by index and work on it, e.g. get or set text of the current
IEdit. Some controls in not FAR.NET dialogs are not fully supported yet.
Example: Complete-Word-.ps1 from PowerShellFar completes a word from history of
any edit contol in any FAR dialog. See also Generate-Dialog-.ps1 as a demo of
access to all dialog controls and properties.

- New IFar.GetDialogHistory() - gets saved dialog history by its name (used by
Complete-Word-.ps1 for completion from editor control history).

- BREAKING: removed IText.Separator2 and converted type of IText.Separator from
bool to int: 0: standard text; 1: single line separator; 2: double line
separator.

- New helper IAnyViewer.ViewText - opens a viewer to view some text. Similar to
IAnyEditor.EditText but you can also choose whether it is modal or not.

- Slightly changed action on setting of IPanel.Path and IPanelPath.Path: if the
panel is a plugin not supporting the path then it is closed and a FAR panel is
opened if the new path exists.

= 3.3.39 =

CHANGED
- VKeyCode names was made compatible with System.ConsoleKey names.

OBSOLETE
- Removed obsolete editor and viewer properties DeleteOnClose and
DeleteOnlyFileOnClose. Use new property DeleteSource (enum DeleteSource).
- Removed obsolete editor events AfterOpen, AfterClose, BeforeSave. Use new
events: Opened, Closed, Saving. Updated demo plugin Plugins.NET \ TrimSaving.

= 3.3.38 =

NEW
- Many new features in IViewer and new interface IAnyViewer. In short, viewer
management is now similar to editor management (but features are different).
- Minor changes in IEditor and replacements for obsoletes (see below).
- IFar: TempName(), TempFolder().

FIX
- Improved error detection on Open() in editor and viewer (it used to throw a
false error in some rare special cases).

OBSOLETE\CHANGED
- Removed editor and viewer properties Async and IsModal. Use new method Open(
OpenMode ). Old method Open() with no parameter works as Open( OpenMode.None ).
- Editor and viewer properties DeleteOnClose and DeleteOnlyFileOnClose will be
removed, use new property and enum DeleteSource.
- Editor events AfterOpen, AfterClose, BeforeSave will be removed because their
names violate .NET naming guidelines; use new events: Opened, Closed, Saving.

= 3.3.37 =

Recommended FAR 1.71.2315

NEW
- IFar.Redraw() for FAR 1.71.2315
- IMenuItem.Disabled works in menus.
- IMenuItem.Text + IsSeparator is shown in menus.
- IMenuItem.From enables\disables a menu item "automatically".
- IMenu: item properties (except Text) can be changed in locked mode.
- BasePlugin.Invoking(): rarely needed, but sometimes useful, see help.
- IUserControl - currently it is not really a user defined control with custom
drawing, but it still can be used to receive some events where other controls
are not suitable.

OBSOLETE
- REMOVED property BreakCode from menus, see 3.3.36 notes.
- Editor and viewer properties Async and IsModal WILL BE REMOVED. Use new method
Open( OpenMode ) with OpenMode enum. Old method Open() with no parameter is also
obsolete for now, don't use it for this transition period; but it will not be
removed, later it will work as Open( OpenMode.None ).

= 3.3.36 =

Requires FAR 1.71 alpha 4 (build 2309)
http://forum.farmanager.com/viewtopic.php?p=29848#29848

NEW IN FAR.NET
- EditorPlugin - yet another plugin helper, see help and examples.

NEW IN FAR API AND FAR.NET
- Support of FAR plugins menu in dialogs.
- IEdit.NoAutoComplete ~ DIF_NOAUTOCOMPLETE.
- Events GotFocus and LosingFocus in plugin panels and editor instances.
- Enum FarMacroState, property IFar.MacroState ~ FARMACROSTATE, MCMD_GETSTATE.

FIXED
- Memory was not freed on PasteFromClipboard().

CHANGED
- Moved property WordDiv from IFar to IAnyEditor.
- Converted property IFar.Editors into method Editors(), it returns an array of
opened editors.

OBSOLETE
- Property BreakCode in menus (IListMenu and IMenu) will be removed, use the new
property BreakKey instead. For IListMenu it is simply renaming; for IMenu it is
not an index of a break key but a key code itself - this way looks more natural
and makes coding and changes easier.

= 3.3.35 =

NEW

- CommandPlugin, FilerPlugin classes - two more plugin helpers, see .CHM help
and Plugins.NET examples.
- ToolPlugin, CommandPlugin, FilerPlugin are normally not preloaded, i.e.
information is read from the registry cache only and an assembly is loaded only
when a plugin feature is invoked.
- FAR.NET config allows to edit file masks of file plugins.
- FAR.NET features are described in .hlf topics (also opened on F1).
- Loading plugins: if a DLL has nothing to load an exception is thrown. This DLL
has to be removed from a plugin folder or a .cfg file has to be used to define
what DLLs and classes are loaded exactly.
- New information in Readme.txt.

FIXED

- Recent bug: can't not open a panel when two panels are already opened.
- Command prefixes were case sensitive.
- IEdit.Line.Insert() did not work.
- A few x64 issues.

CHANGED
- Removed obsolete IFar.Clipboard, use CopyToClipboard and PasteFromClipboard.
- A few breaking renamings in the recent features for the sake of common names
style: RegisterPrefix -> RegisterCommand (actually we register a command, prefix
is only a default suggestion); UnregisterPrefix -> UnregisterCommand;
ExecutingEventArgs -> CommandEventArgs (for plugin); RegisterFile ->
RegisterFiler; UnregisterFile -> UnregisterFiler; OpenFileEventArgs ->
FilerEventArgs.
- RegisterFiler has two more parameters: 'mask' and 'creates'.
- FilerEventArgs.Data type changed from byte[] to System.IO.Stream (to avoid
redundant data copy), see example in Plugins.NET.

= 3.3.34 =

MAIN CHANGES (BREAKING) AND NEW FEATURES
(result of all recent forum discussions)

- IFar.Register*|Unregister* methods are quite different, see .CHM and updated
examples. BasePlugin class can be used as usual with new Register*|Unregister*
methods. There is also a new simpler helper ToolPlugin - all you need is to
implement a single method (other stuff is up to you).
- FAR.NET provides some configuration tools for all its plugins: 1) you can edit
plugin menu strings in different areas (Panels, Editor, Viewer..); 2) you can
edit all prefixes according to your preferences or to resolve conflicts; plugins
may do not care of prefixes in their configurations.
- Removed IFar.From as not really important. Plugin handlers have this info.
Besides, new IFar.GetWindowType() gets almost the same information.
- Slightly changed rules of loading plugins, see Readme.txt.

HOTKEYS

- You have to reset your hotkeys. It is recommended to set the main FAR.NET
hotkey as usual by F4 and set other FAR.NET hotkeys by ampersands in Options \
Plugins configuration \ .NET \ Panels tools, Editor tools, Viewer tools (yes,
.NET plugins may have different hotkeys in different areas).

NEW

- Button [Copy Info] in error dialog copies the error info to the clipboard.
- IFar.PostStep() returns control to FAR and after that invokes a step handler.

FIXED

- "Index out of range" in IListMenu when a key handler changes menu items.

CHANGED

- IFar.Msg(string) and IFar.Msg(string, string) return void. Other Msg methods
as usual return pressed button index or -1 on Escape.
- VKeyCode: some keys were renamed according to .NET naming guidelines.

OBSOLETE

- Property IFar.Clipboard will be removed, use methods CopyToClipboard and
PasteFromClipboard. Property is sometimes triggered when it is not really
wanted: e.g. in debugger, in PowerShell member list and etc.

= 3.3.33 =

NEW

- You can now open as many panels as you want (or keep one invisible for later
use). Of course, only two of them can be shown but the others can be pushed to
the stack by IPluginPanel.Push so that later you can IPluginPanel.Open them.
Another new related methods: IFar.ShowPanelMenu() - panel menu where you can
push a panel or open pushed panels (it is included in plugins and disk menus);
IFar.PushedPanels() - array of pushed panels, IPluginPanel.Post*() - used
internally to remember and restore the current file in a pushed panel.
- IPluginPanel.DotsDescription (used together with AddDots).
- IPluginPanelInfo.InfoItems allows to set custom info panel items.
- IPluginPanelInfo.SetKeyBar*() allows to set custom key bar labels.
- IFar.{Register|Unregister}OpenFile() implements OpenFilePlugin FAR API.
- VKeyCode - some of virtual key codes.

BREAKING CHANGES

- Property AddDots moved from IPluginPanelInfo to IPluginPanel, i.e. item dots
now is rather panel data than info.
- StringDelegate was removed, RegisterPrefix uses now another type of handler:
EventHandler<ExcutingEventArgs>. This way is more flexible for future changes
and allows to RegisterPrefix from PowerShell.
- Removed obsolete IFar.AnotherPanel; use IFar.Panel2 instead.
- Renamed OpenPluginMenuItemEventArgs into PluginMenuEventArgs.

FIXED/IMPROVED

- Fixed IPluginPanel.PuttingFiles Event.
- Fixed (or, say, implemented) processing of AddDots in panels.
- Avoided redundant internal memory allocations on GetPluginInfo().
- IFar.Plugin bug when two plugin panels are opened and one of them is under
the info panel.
- Restored removed by mistake IFar.Unregister* methods.

= 3.3.32 =

FIXED/IMPROVED

- Fixed memory leaks on panel operations.
- Optimized memory use on panel operations.
- Avoided redundant panel updates in some cases.

NEW

- IAnyEditor.EditText() - simple way to edit text in a modal editor.
- IFar.PostMacro()

OBSOLETE/CHANGED/REMOVED

- IFar.AnotherPanel will be removed, use IFar.Panel2 instead.
- Methods IFar.CreateKeySequence() and IFar.PostKeySequence() work with int[],
not IList<int>.
- Removed IPluginMenuItem and CreatePluginsMenuItem, RegisterPlugins*Item. Use
methods RegisterPlugins*Item(string, handler) instead.

= 3.3.31 =

NEW

- IFar.LoadMacros(), IFar.SaveMacros().

REVISION: IMenu, IListMenu

- IMenu does not support filters any more, it is now pure MENU OF COMMANDS, as
simple and effective as possible. If your menu is rather a LIST OF OBJECTS for
selection than use IListMenu, which provides filters: permanent and incremental,
both with variety of PatternOptions.

- Migration from IMenu to IListMenu (if you really need it) is simple: semantics
is the same, just rename IMenu and CreateMenu to IListMenu and CreateListMenu;
actually only keys are different: IMenu uses virtual key codes, IListMenu uses
internal key codes added by AddKey() with optional handlers.

- If you use permanent filter than, to enable it, now you have to define
IListMenu.FilterOption according to your preferences, not FilterKey, which is
now set to default (CtrlDown) and you don't have to fuss about internal codes,
at least for this.

- [F1] in list menus and input filter dialogs opens basic FAR.NET help about
predefined and recommended list menu keys and about patterns used for filters.

= 3.3.30 =

NEW

- IAnyMenu - any menu interface; IMenu is now derived from it.
- IListMenu, Far.CreateListMenu() - new style menu with extra features, e.g.
incremental filter on typing (substring/prefix/wildcard). It is ready to use,
but further changes are very possible.
- Far.CodeToChar() - converts internal key code to char (20h-FFh).
- KeyCode - helper constants for internal key codes (subject to change).

REMOVED
(these changes are unlikely breaking, but...)

- Removed IListItem, use IMenuItem instead (items of combo and list boxes).
In other words property Items of IMenu, IListMenu, IComboBox, IListBox is a
collection of IMenuItem's. If you used IListItem directly, just rename it.
- Removed IMenu.OnClick - it turned out that it was declared but not really
implemented or used. Looks like it was declared by mistake.

= 3.3.29 =

This is mostly a technical build for PowerShellFar.

= 3.3.28 =

- Added property IMenu.Sender:object; this object is passed in event handler as
a sender. By default IMenuItem is a sender.

= 3.3.27 =

This is mostly a technical build for PowerShellFar.

= 3.3.26 =

PLUGIN PANELS
- New property IPluginPanel.StartDirectory (current directory when it starts).

REMOVED
- Removed IFar.UnregisterPluginsDiskItem, IFar.UnregisterPluginsMenuItem, see
explanation in history 3.3.25.

= 3.3.25 =

OBSOLETE
- IFar.UnregisterPluginsDiskItem, IFar.UnregisterPluginsMenuItem are obsolete
and will be removed because they are not really effective: registration is done
only when Connect() is called and it cannot be 'undone'. Besides, when FAR.NET
is disconnected all registered items are 'unregistered' automatically. Example
plugin sources are already updated, you may have to update your existing
plugins too: simply remove calls of these methods. Bonus: you don't have to keep
menu item references waiting for Disconnect() to be unregistered, and in most
cases a plugin does not have to implement Disconnect() at all.

PLUGIN CONFIGURATION
- New method RegisterPluginsConfigItem(): adds "Plugin configuration" item.

WINDOWS
- New property IFar.WindowCount {get}.
- New interface IWindowInfo and enum WindowType.
- New methods IFar: GetWindowInfo(), SetCurrentWindow(), Commit().

DIALOGS
New features mostly simplifying creation of a dialog and especially future
modifications of it (Test-Dialog-.ps1 in PowerShellFar shows them all):
- IDialog.AddBox(): if a parameter right\bottom is 0 then it is calculated;
- New properties IDialog.Rect, IControl.Rect (useful for relative positions);
- New property IDialog.NoSmartCoords. By default coordinates are "smart", i.e.
not positive Top is subtracted from the previous control Top: (0) - the same
line, (-1) - the next line, and so on. See more in help.
- New property IDialog.Cancel:IButton - if it is set and the button is pushed
then Selected is set to this button as usually, but Show() returns false now.

PLUGIN PANELS
- REMOVED property IPluginPanelInfo.ConfirmClose because of FE_CLOSE issues: it
may not happen or it may happen when a panel is not about to close.
- New methods IPanel.Close() and IPanel.Close(string path).
- REMOVED method IFar.ClosePanel(), instead of it use IPanel.Close() (also for
IPluginPanel), i.e. call Far.Panel.Close() to close an active panel,
Far.Panel2.Close() to close a passive panel, <IPluginPanel>.Close() to close a
plugin panel (active or passive).

= 3.3.23 =

- New methods IFar.{Get|Set}PluginValue(string pluginName, string valueName,
object {default|new}Value) to {get|set} a plugin value stored in the registry,
usually at "Software\Far\Plugins" (or "Software\Far\Users\user1\Plugins" if FAR
is started started with '/u user1' parameter). "pluginName" defines a subkey
there; the subkey is created if it does not exist even if you only get a value.

= 3.3.22 =

- Fixed most (all?) of x64 issues. Sources are ready for x64. Currently binaries
are provided for x32 only, sorry for inconvenience.

= 3.3.21 =

This is mostly a technical build for PowerShellFar.

= 3.3.20 =

This is mostly a technical build for PowerShellFar.

= 3.3.19 =

- Added 'set' method to property IPanel.NumericSort.
- Fixed issues in plugin panel start sort modes.

= 3.3.18 =

- Properties IPanel.{ReverseSortOrder | SortMode | ViewMode} are now 'get\set'
(i.e. not 'get' only).
- New properties IFar.{RootFar | RootKey} - registry paths taking into account
a user, e.g. '/u user1' in FAR command line.
- Improved switching\keeping\restoring of plugin panels modes.
- Fixed lib path in Build-JS.bat.
- Fixed ReplaceSlashes.js in examples.

= 3.3.17 =

- removed obsolete properties {ILines | IStrings}.Text; please, use methods
{IEditor | ISelection}.{GetText | SetText}.

= 3.3.16 =

- new property IFar.From:OpenFrom - where a plugin is opened from.
- new property IPanel.Window:Place - panel coordinates.
- new properties IEditor.TrueLines,TrueSelection: no empty last line if any.
They are designed for convenient reading or changing existing lines in foreach
loops; Add(), Insert(), RemoveAt() are available, but not yet recommended, they
can not be used in foreach anyway.

OBSOLETE:
- properties {ILines | IStrings}.Text will be removed; please, use methods
{IEditor | ISelection}.{GetText | SetText} - they will be more effective.
ILines and IStrings will be almost nothing but ILine and string lists.

= 3.3.15 =

- Far.exe.config: added option FarManager.StartupErrorDialog: 0: write error
info to console (default); 1: show standard error dialog (you may want to turn
it on to view error info in viewer (button [Info])).
- fixed exception on clipboard failure.
- fixed broken examples in Plugins.NET folder

= 3.3.14 =

BREAKING CHANGE: some of IFile properties and panel modes enums renamed using
names of standard .NET class FileSystemInfo. Sorry for that, but it should be
much more convenient than to have 3 different set of names for the same things.

Panels:
- change: IFar.CreatePluginPanel() creates a panel, then IPluginPanel.Open()
should be called explicitly.
- removed IPluginPanel.Panel:IPanel. Instead, IPluginPanel is derived from
IPanel and implements some functionality more effectively.
- removed IPanel.Top (it looks like it is not used), use IPanel.TopIndex which
is really needed.
- IFar.Panel, IFar.Panel2: if it is a FAR.NET plugin panel it returns
IPluginPanel (derived from IPanel, see above).
- IFile.Tag:int was replaced with IFile.Data:object, so that you can attach any
objects to your plugin panel items.

= 3.3.13 =

Plugin panels:
- new method IFar.GetPluginPanel().
- removed from public interface property IPluginPanel.Id (used internally).
- new IPluginPanel.Another - another FAR.NET IPluginPanel if it exists.
- new IPluginPanel.Panel - IPanel interface for this IPluginPanel.
- new IPluginPanel.Host - you may use it if you have more than one panel.

Plugin disk menu:
- Added IFar.{Register | Unregister} PluginsDiskItem(): the same as
IFar.{Register | Unregister} PluginsMenuItem() but for FAR disk menu.

= 3.3.12 =

- Updated Plugins.NET\IronPython plugin (by Max Belugin).
- IFar.Input(): added 3 overloaded methods and changed parameter order in
the existing method: prompt, history, title, text.

= 3.3.11 =

- Fixed minor issues on exceptions in plugin panel events.
- IFar: new method Input() - helper to create and show IInputBox.
- IEditor: fixed exceptions from get-properties of not opened editor.
- Added Plugins.NET\Ipy: plugin to run scripts in IronPython (by Max Belugin).

= 3.3.10 =

- IFar: new method ClosePanel(): closes the current plugin panel.
- IPluginPanelInfo: new property ConfirmClose:bool.
- IPanel: new method Redraw(int, int).
- IFile: new property: Tag:int. It works as user data attached to an item.
Unfortunately Data:object, as in other interfaces, is not possible for IFile.
Removed properties Path and ParentPath, sorry for a breaking change, but they
were error prone in many cases (and redundant in many other cases); thus, if you
need parent path take it as IPanel.Path and then you decide what Path is in your
scenario: with slash, backslash, nothing, ... (if you need Path at all).
- Refactoring of panel related interfaces for new plugin panel functionality,
added new features, some minor changes may be breaking.
- Updated documentation.

= 3.3.9 =

- Implemented plugin panel interfaces: main of them are: IPluginPanel and
IPluginPanelInfo. See docs for details. Not yet everything is implemented but
significant part. Everything is a subject to change, this is the first version.
A simple but not really trivial example is Search-Regex-.ps1 in PowerShellFar.
- Refactoring for panel plugins: removed interface IFolder; replaced property
IFolder IFile.Parent with string IFile.ParentPath; replaced property IFolder
IPanel.Contents with IList<IFile> IPanel.Contents.
- Removed from public interface currently redundant IPluginMenuItem.FireOnOpen()
and IMenuItem.FireOnClick().

= 3.3.8 =

- Improved some XML doc code comments, updated CHM help. CHM help: removed MSDN
references, inherited .NET comments and other redundant information.
- Preliminary internal changes for coming features.

= 3.3.7 =

- Created CHM help: from now on the latest version can be downloaded from:
http://code.google.com/p/farnet/downloads/list
- IFar: two new methods Write() appending plain or colored text to the user
screen (under panels).
- FAR.NET does not show now error message boxes during the procedure of loading
plugins (it is annoying if problems are known and temporary). Instead, it writes
all error messages to the user screen and continues.

= 3.3.6 =

- Removed: IMenuItem.Selected and related IMenu.Show(int) and parameters
Selected from several methods IMenuItems.Add(). Instead, IMenu.Show() uses
IMenu.Selected as input if it is set. This way seems more consistent than
approach with IMenuItem.Selected (potential conflict between items).

= 3.3.5 =

- ILine.Pos: setting of a negative value moves cursor to the end of a line.
- New ILine.Length: text length; use it when text itself is irrelevant.
- New IEditor.GoEnd(): effective way to move cursor to the end of file.
- IFar.Msg(): header: chars '\t', '\r', '\n', if any, are replaced with spaces.
- Removed FarPluginsLoader.dll; you have to do it manually (in %FARHOME%\Lib).
- Fixed recent bugs in menus.
- New property IMenu.SelectLast: tells to select the last item.
- New IMenu feature: filters. See XML docs for properties Filter, FilterKey,
FilterHistory, FilterRestore.

= 3.3.4 =

- Implemented IEdit\IComboBox.Line.Selection.
- Interfaces IRect, IStream, ITwoPoints are replaced with value type with
neutral name Place which can be used as Rect, Stream or TwoPoints.
- New properties HelpTopic in IDialog, IMenu, IInputBox, IMessage and new method
IFar.ShowHelp().
- Removed FarDotNetStruct.dll; you should remove it manually if you have one,
normally it is in here: "%FARHOME%\Lib\".

= 3.3.3 =

- New editor methods Begin()\End(). They drastically improve performance of
operations on large number of editor lines. Example: an operation used to take
2-3 minutes on a file containing 40,000 lines; now being used with Begin\End it
takes 4 seconds.
- Interface ICursor is replaced with struct TextFrame + related properties
Frame, Cursor and methods GoTo*.
- New property Line (ILine) in IEdit and IComboBox.
- Fixed crash in dialogs on Idled event.

= 3.3.2 =

- Fixed IInputBox.History issue.
- IEditor: new ConvertPosToTab(), ConvertTabToPos() and ConvertScreenToCursor()
- IMenu.Show() automatically changes coordinate Y (if >= 0) if items are out of
the screen.
- Interface IPoint is replaced with struct Point.

= 3.3.1 =

- New dialog item IComboBox, IListBox, password editor and vertical text or
separator.
- Implemented main dialog events. See Test-Dialog-.ps1 in PowerShellFar 1.1.1
for examples.
- Most of dialog items properties are dynamic, i.e. when a dialog is started
they reflect the current dialog state both for reading and writing. Example:
Test-Dialog-.ps1 - button [Test] and related code.
- IFar.Msg(): supported line delimiters are \r, \n è \r\n, Tabs are replaced
with spaces. Text is wrapped if required. Two new methods IFar.Msg() with more
options.
- Revision of old Key, Mouse and related events. New structs are KeyInfo and
MouseInfo.

= 3.3.0 =

- FarManager.Forms: implemented IDialog, IBox (double, single), IButton,
ICheckBox, IEdit (standard, fixed), IRadioButton, IText. Example -
Test-Dialog-.ps1 in PowerShellFar 1.1.0.
- New method IFar.CreateViewer() and interface IViewer.
- New method IFar.WriteText().
- Revision of IInputBox.
- IFar.PostText() processes \n, \r and \r\n as Enter. Empty text and empty key
sequence for IFar.PostKeys() is not an error.
- Optimized some string operations.

= 3.2.9 =

- Improved exception handling.
- New IFar.ShowError() for internal use but can be used externally as well.
- New IFar.PostText().

= 3.2.8 =

- New IFar.GetHistory()
- IVersion is replaced with System.Version

= 3.2.7 =

- New IEditor.CurrentLine of type ILine.
- New in ILine: Pos, Insert(), Select(), Unselect().
- IFar.CommandLine is ILine now. ICommandLine is removed.
- IFar.GetUserScreen() sends "user screen" to screen. Far >= 1.71.2187.
- IPanel.IsVisible is get\set (set works via sending CtrlF1\F2).

= 3.2.6 =

- New IMenuItem.Data, IMenu.SelectedData, IPanel.NumericSort,
IFar.SetUserScreen(), ICommandLine.Insert().
- IEditor.ExpandTabs type is enum ExpandTabsMode.
- Improved some exceptions info.

= 3.2.5 =

- Minor changes in IMenu è ISelection and fix of potential crash of a menu with
incorrect coordinates.

= 3.2.4 =

- Main editor functionality is now implemented as it was designed.
- Vast revision of existing IEditor implementation.
- New IEditor.Bookmarks().
- New properties in IPanel, mostly 'get', but Path is also 'set'.
- New interface ICommandLine and property IFar.CommandLine.
- Examples: added Build-CS.bat, Build-JS.bat, Build-VB.bat.

= 3.2.3 =

- Implemented lists in editor.
- All collections are generic now.
- All event handlers are standard now (i.e.: object sender, ..EventArgs e).

= 3.2.1 =

- Fixed selection in editor.
- Completed .NET 2.0 porting.

= 3.1.? and older =

- 29.08.06 - ported to .NET 2.0
- 19.08.05 - beta stage
- editor fixes
- new plugin loading scheme
- new IFar.RegisterPluginsMenuItem(name, onclick)
- new IMenuItems.Add(name, onclick)
- XML comments in FarNetIntf.dll
- 11.08.05 - alpha stage
- new settings in Far.exe.config
- further editor implementation
- added demo plugins: CopyShared, JS.NetCalc, ReplaceSlashes
- 19.07.05 - started implementation of editor, fixed bugs in panels
- 16.05.05 - implemented SHPCE 2.0 functionality (except editor)
